@using Orchard.UI.Resources

@{
    var theme = WorkContext.CurrentTheme;
    var faviconsPath = theme.Location + "/" + theme.Path + "/Images/Favicons/";

    RegisterFavicon(faviconsPath, "shortcut icon", "favicon.ico");
    RegisterFavicon(faviconsPath, "icon", "android-icon-36x36.png", "36x36", "image/png");
    RegisterFavicon(faviconsPath, "icon", "android-icon-48x48.png", "48x48", "image/png");
    RegisterFavicon(faviconsPath, "icon", "android-icon-72x72.png", "72x72", "image/png");
    RegisterFavicon(faviconsPath, "icon", "android-icon-96x96.png", "96x96", "image/png");
    RegisterFavicon(faviconsPath, "icon", "android-icon-144x144.png", "144x144", "image/png");
    RegisterFavicon(faviconsPath, "icon", "android-icon-192x192.png", "192x192", "image/png");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon.png");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-57x57.png", "57x57");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-60x60.png", "60x60");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-72x72.png", "72x72");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-76x76.png", "76x76");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-114x114.png", "114x114");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-120x120.png", "120x120");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-144x144.png", "144x144");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-152x152.png", "152x152");
    RegisterFavicon(faviconsPath, "apple-touch-icon", "apple-icon-180x180.png", "180x180");
    RegisterFavicon(faviconsPath, "apple-touch-icon-precomposed", "apple-icon-precomposed.png", "180x180");
    RegisterFavicon(faviconsPath, "manifest", "manifest.json");

    // Windows tile icon support.
    SetMeta("msapplication-TileColor", "#ffffff");
    SetMeta("msapplication-TileImage", Url.Content(faviconsPath + "ms-icon-144x144.png"));
    SetMeta("msapplication-TileImage", Url.Content(faviconsPath + "ms-icon-150x150.png"));
    SetMeta("msapplication-TileImage", Url.Content(faviconsPath + "ms-icon-310x310.png"));
    SetMeta("msapplication-TileImage", Url.Content(faviconsPath + "ms-icon-70x70.png"));
}

@functions
{
    private void RegisterFavicon(string faviconsPath, string rel, string href)
    {
        RegisterLink(new LinkEntry
        {
            Rel = rel,
            Href = Url.Content(faviconsPath + href)
        });
    }

    private void RegisterFavicon(string faviconsPath, string rel, string href, string sizes)
    {
        RegisterLink(new LinkEntry
        {
            Rel = rel,
            Href = Url.Content(faviconsPath + href)
        }
        .AddAttribute("Sizes", sizes));
    }

    private void RegisterFavicon(string faviconsPath, string rel, string href, string sizes, string type)
    {
        RegisterLink(new LinkEntry
        {
            Type = type,
            Rel = rel,
            Href = Url.Content(faviconsPath + href)
        }
        .AddAttribute("Sizes", sizes));
    }
}